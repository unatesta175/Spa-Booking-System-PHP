# Environment Configuration Setup

## Overview
ToyyibPay API keys and other sensitive credentials have been moved to environment variables for better security.

## Installation Steps

### 1. Create the .env file
Rename `env.template` to `.env`:

**Windows Command Prompt:**
```bash
copy env.template .env
```

**Windows PowerShell:**
```powershell
Copy-Item env.template .env
```

**Linux/Mac:**
```bash
cp env.template .env
```

### 2. Configure Your API Keys
Open the `.env` file and verify/update your ToyyibPay credentials:

```env
TOYYIBPAY_SECRET_KEY=m8zfj65c-2fzo-gq3b-rwhw-xvneusqy7wuy
TOYYIBPAY_CATEGORY_CODE=2n8qqo61
```

### 3. Secure the .env File
The `.env` file is already added to `.gitignore` to prevent it from being committed to version control.

**Important Security Notes:**
- ✅ The `.env` file contains sensitive credentials
- ✅ Never commit the `.env` file to Git
- ✅ Share `.env.example` (template) instead
- ✅ Each developer/server should have their own `.env` file

## How It Works

### Environment Loader
The `components/env_loader.php` file automatically loads environment variables from the `.env` file.

### Usage in Code
Instead of hardcoding credentials:

**❌ Old Way (Insecure):**
```php
'userSecretKey' => 'm8zfj65c-2fzo-gq3b-rwhw-xvneusqy7wuy',
'categoryCode' => '2n8qqo61',
```

**✅ New Way (Secure):**
```php
'userSecretKey' => env('TOYYIBPAY_SECRET_KEY'),
'categoryCode' => env('TOYYIBPAY_CATEGORY_CODE'),
```

### Files Updated
The following files now use environment variables:
- `getBookingInsertion.php`
- `admin/getBookingInsertion.php`
- `admin/getBookingInsertion copy.php`
- `staff/getBookingInsertion.php`
- `bookingtestold.php`

## Troubleshooting

### Error: ".env file not found"
**Solution:** Make sure you renamed `env.template` to `.env`

### Error: "Undefined function env()"
**Solution:** Make sure `require_once 'components/env_loader.php';` is included at the top of your PHP file

### API Keys Not Working
**Solution:** 
1. Check that `.env` file exists in the root directory
2. Verify the keys in `.env` are correct
3. Clear any PHP cache if using OpCache

## Production Deployment

When deploying to production:

1. Create a fresh `.env` file on the server
2. Use production API keys (not development keys)
3. Set appropriate file permissions:
   ```bash
   chmod 600 .env
   ```
4. Never expose the `.env` file via web server

## Adding More Environment Variables

To add new environment variables:

1. Add to `.env`:
   ```env
   NEW_VARIABLE=value
   ```

2. Add to `env.example.template` (with placeholder):
   ```env
   NEW_VARIABLE=your_value_here
   ```

3. Use in code:
   ```php
   $value = env('NEW_VARIABLE');
   ```

## Support

For issues or questions, refer to the project documentation or contact your system administrator.

